<!DOCTYPE html>
<html>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58227951-1', 'http://hanzratech.in');
  ga('send', 'pageview');

</script>


  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Texture Matching using Local Binary Patterns (LBP), OpenCV, scikit-learn and Python</title>
    <meta name="description" content="Computer Vision and Programming blog
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://bikz05.github.io/2015/05/30/local-binary-patterns.html">
</head>


  <link href='http://fonts.googleapis.com/css?family=Poiret+One' rel='stylesheet' type='text/css'>
<!--
font-family: 'Poiret One', cursive;
-->
<link href='http://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
<!--
font-family: 'Share Tech Mono', ;
-->
<link href='http://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>
<!--
font-family: 'Indie Flower', cursive;
-->
<link href='http://fonts.googleapis.com/css?family=Cutive+Mono' rel='stylesheet' type='text/css'>
<!--
font-family: 'Cutive Mono', ;
-->
<link href='http://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
<!--
font-family: 'Roboto', sans-serif;
-->


  <body>
    
    <header class="site-header">

  <div class="wrapper">

    <!-- <a class="site-title" href="/">Hanzra Tech</a> -->
    
    <a class="site-title" href="/"><img src="/assets/logo/hanzratech-logo.png" alt="Hanzra Tech" style="width:144px;height:50px"></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger" style="font-family: 'Indie Flower', cursive;">
        
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	  <a class="page-link" href="/contact/">Contact</a>
	  
	
	  
	  <a class="page-link" href="/about/">About</a>
	  
	
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "e95f9855-8c25-452f-a5aa-52401715f9e1", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script>

    <h1 class="post-title" style="font-family: 'Indie Flower', cursive;">Texture Matching using Local Binary Patterns (LBP), OpenCV, scikit-learn and Python</h1>
    <p class="post-meta">May 30, 2015 • Bikramjot Singh Hanzra
<br>Posted under 
<!--  
 -->
<span class="bikzclick_tag"><a href="/categories/chi-squared-distance">chi-squared distance</a></span>
<!--  
 -->
<span class="bikzclick_tag"><a href="/categories/local-binary-patterns">local binary patterns</a></span>
<!--  
 -->
<span class="bikzclick_tag"><a href="/categories/opencv">opencv</a></span>
<!--  
 -->
<span class="bikzclick_tag"><a href="/categories/python">python</a></span> 
</p>
  </header>

  <article class="post-content" style="font-family: 'Roboto', sans-serif;">
    <style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container"><iframe src="http://www.youtube.com/embed/lIgqjRe88_s" frameborder="0" allowfullscreen=""></iframe></div>
<p><br /></p>

<p>In this tutorial, I will discuss about how to perform texture matching using Local Binary Patterns (LBP). Local Binary Patterns is an important feature descriptor that is used in computer vision for texture matching. It was first released in 1990 and subsequently various modified versions have been released.</p>

<h1 id="lbp-descriptor">LBP Descriptor</h1>

<p>Let’s first discuss how to calculate the LBP Descriptor. Firstly, we convert the input color image to grayscale, since LBP works on grayscale images. For each pixel in the grayscale image, a neighbourhood is selected around the current pixel and then we calculate the LBP value for the pixel using the neighbourhood. After calculating the LBP value of the current pixel, we update the corresponding pixel location in the LBP mask (It is of same height and width as the input image.) with the LBP value calculated as shown below. In the image, we have 8 neighbouring pixels.</p>
<figure id="figure-1"><a href="/figures/2015-05-30-local-binary-patterns/lbp-2.png"><img src="/figures/2015-05-30-local-binary-patterns/lbp-2.png" alt="Grayscale Image to LBP Mask" /></a><figcaption>Figure 1: Grayscale Image to LBP Mask [<a href="/figures/2015-05-30-local-binary-patterns/lbp-2.png">PNG</a>]</figcaption></figure>

<p><em>But how is the LBP values calculated?</em></p>

<p>To calculate the LBP value for a pixel in the grayscale image, we compare the central pixel value with the neighbouring pixel values. We can start from any neighbouring pixel and then we can transverse either in clockwise or anti-clockwise direction but we must use the same order for all the pixels. Since there are 8 neighbouring pixels – for each pixel, we will perform 8 comparisons. The results of the comparisons are stored in a 8-bit binary array.</p>

<p><strong>If the current pixel value is greater or equal to the neighbouring pixel value, the corresponding bit in the binary array is set to 1 else if the current pixel value is less than the neighbouring pixel value, the corresponding bit in the binary array is set to 0.</strong></p>

<p>The whole process is shown in the image below (Figure 2). The current (central) pixel has value 7. We start comparing from the neighbouring pixel where the label 0. The value of the neighbouring pixel with label 0 is 2. Since it is less than the current pixel value which is 7, we reset the 0th bit location in the 8 bit binary array to 0. We then iterate in the counter-clockwise direction. The next label location 1 have value 7 which is equal to the current pixel value, so we set the 1st bit location in the 8 bit binary to 1. We then continue to move to the next neighbouring pixel until we reach the 8th neighbouring pixel. Then the 8-bit binary pattern is converted to a decimal number and the decimal number is then stored in the corresponding pixel location in the LBP mask.</p>

<figure id="figure-2"><a href="/figures/2015-05-30-local-binary-patterns/lbp-1.png"><img src="/figures/2015-05-30-local-binary-patterns/lbp-1.png" alt="Calculation of LBP values" /></a><figcaption>Figure 2: Calculation of LBP values [<a href="/figures/2015-05-30-local-binary-patterns/lbp-1.png">PNG</a>]</figcaption></figure>

<p>Once we have calculated the LBP Mask, we calculate the LBP histogram. The LBP mask values range from 0 to 255, so our LBP Descriptor will be of size 1x256. We then normalize the LBP histogram. The image below shows the scheme of the algorithm -</p>

<ol>
  <li>Load the color image.</li>
  <li>Convert to grayscale image.</li>
  <li>Calculate the LBP mask.</li>
  <li>Calculate the LBP Histogram and normalize it.</li>
</ol>

<figure id="figure-3"><a href="/figures/2015-05-30-local-binary-patterns/lbp-3.png"><img src="/figures/2015-05-30-local-binary-patterns/lbp-3.png" alt="Color Image -&gt; Grayscale Image -&gt; LBP Mask -&gt; Normalized LBP Histogram" /></a><figcaption>Figure 3: Color Image -&gt; Grayscale Image -&gt; LBP Mask -&gt; Normalized LBP Histogram [<a href="/figures/2015-05-30-local-binary-patterns/lbp-3.png">PNG</a>]</figcaption></figure>

<p>One advantage of LBP is that it is illumination and translation invariant. We have selected a 8 point neighbourhood, but most implementations use a circular neighbourhood as shown below. In the code, we will use a circular neighbourhood.</p>

<figure id="figure-4"><a href="/figures/2015-05-30-local-binary-patterns/lbp-4.png"><img src="/figures/2015-05-30-local-binary-patterns/lbp-4.png" alt="Circular Neighbourhood" /></a><figcaption>Figure 4: Circular Neighbourhood [<a href="/figures/2015-05-30-local-binary-patterns/lbp-4.png">PNG</a>]</figcaption></figure>

<p>The original LBP algorithm has been further optimised to give better results. One such implementation is the <strong>Uniform LBP</strong>. In the code, we will use Uniform LBP.</p>

<p><em>That’s LBP for you</em>, now let’s get started with the programming part <img class="emoji" title=":smile:" alt=":smile:" src="https://assets.github.com/images/icons/emoji/unicode/1f604.png" height="20" width="20" align="absmiddle" /></p>

<h1 id="import-the-required-modules">Import the required modules</h1>

<p>The first step is to import the required modules. Since I am working in IPython Notebook, I have imported the <code>pylab</code> module in inline mode since it seamlessly embeds the images within the notebook. Otherwise, a seperate window opens which makes working with IPython Notebooks cumbersome. We will use the <code>cv2</code> module to read the images, perform color space transformations etc. The <code>os</code> module is used to perform path manipulations. We will leverage the <code>local_binary_pattern</code> function from the <code>skimage.feature</code> module to calculate the LBP mask. From the LBP mask we will calculate the LBP histogram using <code>scipy.stats.itemfreq</code> function and then we will use the <code>sklearn.preprocessing.normalize</code> function to normalize the histogram. <code>cvutils</code> is a utility package for working with computer vision and image processing packages. Use the command, <code>pip install cvutils</code> to install the package. Finally, the <code>csv</code> module provides functionality to parse text files.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">import</span><span class="o">-</span><span class="nb">all</span>
<span class="c"># OpenCV bindings</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="c"># To performing path manipulations </span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c"># Local Binary Pattern function</span>
<span class="kn">from</span> <span class="nn">skimage.feature</span> <span class="kn">import</span> <span class="n">local_binary_pattern</span>
<span class="c"># To calculate a normalized histogram </span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">itemfreq</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">normalize</span>
<span class="c"># Utility package -- use pip install cvutils to install</span>
<span class="kn">import</span> <span class="nn">cvutils</span>
<span class="c"># To read class from file</span>
<span class="kn">import</span> <span class="nn">csv</span></code></pre></div>

<h1 id="prepare-the-training-set">Prepare the training set</h1>
<p>I have assorted 6 training images. The 6 images consists of 2 images of rocks, 2 images of grass and 2 images of checkered patterns. I have also created a <code>class_train.txt</code> file which looks like -</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">rock-1.jpg 0
rock-2.jpg 0
grass-1.jpg 1
grass-2.jpg 1
checkered-1.jpg 2
checkered-2.jpg 2</code></pre></div>

<p>Each line consists of the image name followed by the class label. I have given the following labels for each class -</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Class</th>
      <th style="text-align: center">Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Rock</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">Grass</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">Checkered</td>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<p>Although, I haven’t used the class labels in this tutorial but it is always better to prepare a structure that can be used later on. For example, these labels can be useful if let’s say an SVM is used for classification.</p>

<p>So, let’s write the code to store the path of all the images in the training set.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="c"># Store the path of training images in train_images</span>
<span class="lineno">2</span> <span class="n">train_images</span> <span class="o">=</span> <span class="n">cvutils</span><span class="o">.</span><span class="n">imlist</span><span class="p">(</span><span class="s">&quot;../data/lbp/train/&quot;</span><span class="p">)</span>
<span class="lineno">3</span> <span class="c"># Dictionary containing image paths as keys and corresponding label as value</span>
<span class="lineno">4</span> <span class="n">train_dic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="lineno">5</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;../data/lbp/class_train.txt&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
<span class="lineno">6</span>     <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
<span class="lineno">7</span>     <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
<span class="lineno">8</span>         <span class="n">train_dic</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></code></pre></div>

<p>In line 2, we store all the paths of the training images in a list named <code>train_images</code>. In line 4, we create a dictionary <code>train_dic</code> that will contain the image name and the corresponding class label. From line 5 to 8, we read lines from the <code>class_train.txt</code> document described above and  then we add the key-value pair – (image name, class label) to <code>train-dic</code>.</p>

<p><code>train_images</code> contains the following image paths -</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="p">[</span><span class="s">&#39;../data/lbp/train/rock-1.jpg&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/train/rock-2.jpg&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/train/grass-2.jpg&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/train/checkered-2.jpg&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/train/checkered-1.jpg&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/train/grass-1.jpg&#39;</span><span class="p">]</span></code></pre></div>

<p><code>train-dic</code> contains the following key-value pairs -</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="p">{</span><span class="s">&#39;grass-1.jpg&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;rock-1.jpg&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;checkered-2.jpg&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;rock-2.jpg&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;checkered-1.jpg&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;grass-2.jpg&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span></code></pre></div>

<h1 id="calculate-the-lbp-histograms">Calculate the LBP Histograms</h1>

<p>Now the next step is to calculate the normalized LBP histograms of the training images. Here is the code for the same -</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="c"># List for storing the LBP Histograms, address of images and the corresponding label </span>
<span class="lineno"> 2</span> <span class="n">X_test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 3</span> <span class="n">X_name</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 4</span> <span class="n">y_test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span> <span class="c"># For each image in the training set calculate the LBP histogram</span>
<span class="lineno"> 7</span> <span class="c"># and update X_test, X_name and y_test</span>
<span class="lineno"> 8</span> <span class="k">for</span> <span class="n">train_image</span> <span class="ow">in</span> <span class="n">train_images</span><span class="p">:</span>
<span class="lineno"> 9</span>     <span class="c"># Read the image</span>
<span class="lineno">10</span>     <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">train_image</span><span class="p">)</span>
<span class="lineno">11</span>     <span class="c"># Convert to grayscale as LBP works on grayscale image</span>
<span class="lineno">12</span>     <span class="n">im_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
<span class="lineno">13</span>     <span class="n">radius</span> <span class="o">=</span> <span class="mi">3</span>
<span class="lineno">14</span>     <span class="c"># Number of points to be considered as neighbourers </span>
<span class="lineno">15</span>     <span class="n">no_points</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">radius</span>
<span class="lineno">16</span>     <span class="c"># Uniform LBP is used</span>
<span class="lineno">17</span>     <span class="n">lbp</span> <span class="o">=</span> <span class="n">local_binary_pattern</span><span class="p">(</span><span class="n">im_gray</span><span class="p">,</span> <span class="n">no_points</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;uniform&#39;</span><span class="p">)</span>
<span class="lineno">18</span>     <span class="c"># Calculate the histogram</span>
<span class="lineno">19</span>     <span class="n">x</span> <span class="o">=</span> <span class="n">itemfreq</span><span class="p">(</span><span class="n">lbp</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="lineno">20</span>     <span class="c"># Normalize the histogram</span>
<span class="lineno">21</span>     <span class="n">hist</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="lineno">22</span>     <span class="c"># Append image path in X_name</span>
<span class="lineno">23</span>     <span class="n">X_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_image</span><span class="p">)</span>
<span class="lineno">24</span>     <span class="c"># Append histogram to X_name</span>
<span class="lineno">25</span>     <span class="n">X_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="lineno">26</span>     <span class="c"># Append class label in y_test</span>
<span class="lineno">27</span>     <span class="n">y_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_dic</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_image</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>
<span class="lineno">28</span>     
<span class="lineno">29</span> <span class="c"># Display the training images</span>
<span class="lineno">30</span> <span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="lineno">31</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="lineno">32</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">)</span>
<span class="lineno">33</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
<span class="lineno">34</span>     <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
<span class="lineno">35</span>         <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">X_name</span><span class="p">[</span><span class="n">row</span><span class="o">*</span><span class="n">ncols</span><span class="o">+</span><span class="n">col</span><span class="p">]),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="lineno">36</span>         <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<span class="lineno">37</span>         <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X_name</span><span class="p">[</span><span class="n">row</span><span class="o">*</span><span class="n">ncols</span><span class="o">+</span><span class="n">col</span><span class="p">])[</span><span class="mi">1</span><span class="p">]))</span></code></pre></div>

<p>Let’s break up the above code. In line 2-4, we create 3 lists –</p>

<ol>
  <li><code>X_test</code> - to store the normalized LBP Histograms</li>
  <li><code>X_name</code> - to store the address of images</li>
  <li><code>y_test</code> - to store the corresponding class label</li>
</ol>

<p>Each index in all the 3 lists corresponds to the same image.</p>

<p>From line 8 to 27 we loop over all the images in the training set and calculate the normalized LBP histograms for the training images. So firstly in line 10, we read the current image using the <code>cv2.imread</code> function. We then convert the image to grayscale since LBP works on grayscale image. In line 17, we calculate the LBP mask. We set the radius of the neighbourhood to 3 and the number of points to be equal to 24. Once we have the mask, we calculate the LBP histogram in line 19 and normalize it in line 21.
Next, we append the histogram to the list <code>X_test</code>in line 25. We also append the image name to the list <code>X_name</code> and the image class label to <code>y_test</code>.</p>

<p>Next from line 30 to 37, we display the 6 training images. The image generated is -</p>

<figure id="figure-5"><a href="/figures/2015-05-30-local-binary-patterns/training-set.png"><img src="/figures/2015-05-30-local-binary-patterns/training-set.png" alt="Testing Set" /></a><figcaption>Figure 5: Testing Set [<a href="/figures/2015-05-30-local-binary-patterns/training-set.png">PNG</a>]</figcaption></figure>

<h1 id="get-the-testing-images">Get the testing images</h1>

<p>To test the performance of the LBP algorithm, I have again assorted 3 images of each class not present in the training set. We will read the paths of the 3 images and append them to a list named <code>test_images</code>. We will also create a dictionary <code>test_dic</code> similar to the dictionary <code>train_dic</code> created above. Here is the code for the same-</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">1</span> <span class="c"># Store the path of testing images in test_images</span>
<span class="lineno">2</span> <span class="n">test_images</span> <span class="o">=</span> <span class="n">cvutils</span><span class="o">.</span><span class="n">imlist</span><span class="p">(</span><span class="s">&quot;../data/lbp/test/&quot;</span><span class="p">)</span>
<span class="lineno">3</span> <span class="c"># Dictionary containing image paths as keys and corresponding label as value</span>
<span class="lineno">4</span> <span class="n">test_dic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="lineno">5</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;../data/lbp/class_test.txt&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
<span class="lineno">6</span>     <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
<span class="lineno">7</span>     <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
<span class="lineno">8</span>         <span class="n">test_dic</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></code></pre></div>

<p>The contents of <code>test_images</code> and <code>test_dic</code> are -</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># test_images</span>
<span class="p">[</span><span class="s">&#39;../data/lbp/test/rock-1.png&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/test/checkered-1.jpg&#39;</span><span class="p">,</span> <span class="s">&#39;../data/lbp/test/grass-1.jpg&#39;</span><span class="p">]</span>
<span class="c"># test_dic</span>
<span class="p">{</span><span class="s">&#39;rock-1.png&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;grass-1.jpg&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;checkered-1.jpg&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span></code></pre></div>

<h1 id="calculate-the-chi-squared-distance-for-each-testing-image">Calculate the Chi-squared distance for each testing image</h1>

<p>We then calculate the normalized LBP histograms for each image in the testing set and then we compare the normalized LBP Histograms of the training images (calculated above) with these using the Chi-Squared distance metric. We then sort the results based on the Chi-Squared distance and display the results in sorted order. <strong>The lower the Chi-Squared distance, the better is the match.</strong></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="k">for</span> <span class="n">test_image</span> <span class="ow">in</span> <span class="n">test_images</span><span class="p">:</span>
<span class="lineno"> 2</span>      <span class="c"># Read the image</span>
<span class="lineno"> 3</span>     <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">test_image</span><span class="p">)</span>
<span class="lineno"> 4</span>     <span class="c"># Convert to grayscale as LBP works on grayscale image</span>
<span class="lineno"> 5</span>     <span class="n">im_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
<span class="lineno"> 6</span>     <span class="n">radius</span> <span class="o">=</span> <span class="mi">3</span>
<span class="lineno"> 7</span>     <span class="c"># Number of points to be considered as neighbourers </span>
<span class="lineno"> 8</span>     <span class="n">no_points</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">radius</span>
<span class="lineno"> 9</span>     <span class="c"># Uniform LBP is used</span>
<span class="lineno">10</span>     <span class="n">lbp</span> <span class="o">=</span> <span class="n">local_binary_pattern</span><span class="p">(</span><span class="n">im_gray</span><span class="p">,</span> <span class="n">no_points</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;uniform&#39;</span><span class="p">)</span>
<span class="lineno">11</span>     <span class="c"># Calculate the histogram</span>
<span class="lineno">12</span>     <span class="n">x</span> <span class="o">=</span> <span class="n">itemfreq</span><span class="p">(</span><span class="n">lbp</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="lineno">13</span>     <span class="c"># Normalize the histogram</span>
<span class="lineno">14</span>     <span class="n">hist</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="lineno">15</span>     <span class="c"># Display the query image</span>
<span class="lineno">16</span>     <span class="n">cvutils</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">&quot;** Query Image -&gt; {}**&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_image</span><span class="p">),</span> <span class="n">im</span><span class="p">)</span>
<span class="lineno">17</span>     <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno">18</span>     <span class="c"># For each image in the training dataset</span>
<span class="lineno">19</span>     <span class="c"># Calculate the chi-squared distance and the sort the values</span>
<span class="lineno">20</span>     <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_test</span><span class="p">):</span>
<span class="lineno">21</span>         <span class="n">score</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compareHist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cv</span><span class="o">.</span><span class="n">CV_COMP_CHISQR</span><span class="p">)</span>
<span class="lineno">22</span>         <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X_name</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="nb">round</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="lineno">23</span>     <span class="n">results</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">score</span><span class="p">:</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="lineno">24</span>     <span class="c"># Display the results</span>
<span class="lineno">25</span>     <span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="lineno">26</span>     <span class="n">ncols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="lineno">27</span>     <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">)</span>
<span class="lineno">28</span>     <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">&quot;** Scores for -&gt; {}**&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_image</span><span class="p">))</span>
<span class="lineno">29</span>     <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
<span class="lineno">30</span>         <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
<span class="lineno">31</span>             <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">row</span><span class="o">*</span><span class="n">ncols</span><span class="o">+</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="lineno">32</span>             <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<span class="lineno">33</span>             <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Score {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">row</span><span class="o">*</span><span class="n">ncols</span><span class="o">+</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span></code></pre></div>

<p>From line 1 to 14, we calculate the normalized LBP histograms as in the case of training images. In line 21, we calculate the Chi-Squared Distance of the testing image with all the training images using the <code>cv2.compareHist</code> function. Then, we sort the scores in line 22. From line 25 to 33, we display the training images with the corresponding score.</p>

<h1 id="results">Results</h1>

<p>Let’s check out the results.</p>

<p><strong>Input Image – ROCK Class</strong></p>

<p>Here is an input image of a rock texture.</p>
<figure id="figure-6"><a href="/figures/2015-05-30-local-binary-patterns/query-image-1.png"><img src="/figures/2015-05-30-local-binary-patterns/query-image-1.png" alt="Query Image of Rock Texture" /></a><figcaption>Figure 6: Query Image of Rock Texture [<a href="/figures/2015-05-30-local-binary-patterns/query-image-1.png">PNG</a>]</figcaption></figure>

<p><em>Matching Scores</em> - Below are the sorted results of matching. The top 2 scores are of rock texture.</p>
<figure id="figure-7"><a href="/figures/2015-05-30-local-binary-patterns/query-image-results-1.png"><img src="/figures/2015-05-30-local-binary-patterns/query-image-results-1.png" alt="Matching Scores" /></a><figcaption>Figure 7: Matching Scores [<a href="/figures/2015-05-30-local-binary-patterns/query-image-results-1.png">PNG</a>]</figcaption></figure>

<p><strong>Input Image – CHECKERED Class</strong></p>

<p>Here is an input image of a checkered texture .</p>
<figure id="figure-8"><a href="/figures/2015-05-30-local-binary-patterns/query-image-2.png"><img src="/figures/2015-05-30-local-binary-patterns/query-image-2.png" alt="Query Image of Checkered Texture" /></a><figcaption>Figure 8: Query Image of Checkered Texture [<a href="/figures/2015-05-30-local-binary-patterns/query-image-2.png">PNG</a>]</figcaption></figure>

<p><em>Matching Scores</em> - Below are the sorted results of matching. The top 2 scores are of checkered texture.</p>
<figure id="figure-9"><a href="/figures/2015-05-30-local-binary-patterns/query-image-results-2.png"><img src="/figures/2015-05-30-local-binary-patterns/query-image-results-2.png" alt="Matching Scores" /></a><figcaption>Figure 9: Matching Scores [<a href="/figures/2015-05-30-local-binary-patterns/query-image-results-2.png">PNG</a>]</figcaption></figure>

<p><strong>Input Image – GRASS Class</strong></p>

<p>Here is an input image of a grass texture.</p>
<figure id="figure-10"><a href="/figures/2015-05-30-local-binary-patterns/query-image-3.png"><img src="/figures/2015-05-30-local-binary-patterns/query-image-3.png" alt="Query Image of Grass Texture" /></a><figcaption>Figure 10: Query Image of Grass Texture [<a href="/figures/2015-05-30-local-binary-patterns/query-image-3.png">PNG</a>]</figcaption></figure>

<p><em>Matching Scores</em> - Below are the sorted results of matching. The top 2 scores are of grass texture.</p>
<figure id="figure-11"><a href="/figures/2015-05-30-local-binary-patterns/query-image-results-3.png"><img src="/figures/2015-05-30-local-binary-patterns/query-image-results-3.png" alt="Matching Scores" /></a><figcaption>Figure 11: Matching Scores [<a href="/figures/2015-05-30-local-binary-patterns/query-image-results-3.png">PNG</a>]</figcaption></figure>

<p><strong>Inference – In each case, the best 2 results outperform the next matches by atleast a single significant digit – sufficient to prove the potency of LBP for texture matching.</strong></p>

<h1 id="download-the-code">Download the code</h1>

<p><span class="bikzclick">
<a href="http://bit.ly/1bWfPBF">Click here to Download the code</a>
</span></p>

<ul>
  <li><img class="emoji" title=":octocat:" alt=":octocat:" src="https://assets.github.com/images/icons/emoji/octocat.png" height="20" width="20" align="absmiddle" /> View the GitHub repository <a href="https://github.com/bikz05/texture-matching">here</a>. <!-- Place this tag where you want the button to render. --></li>
  <li>Download the Ipython Notebook from <a href="http://bit.ly/1Jn9Raw">here</a>.</li>
  <li>View the Ipython Notebook <a href="http://bit.ly/1Ppo8Z0">here</a>.</li>
</ul>

<p><a class="github-button" href="https://github.com/bikz05/texture-matching" data-icon="octicon-star" data-style="mega" aria-label="Star bikz05/texture-matching on GitHub">Star</a></p>

<p>I hope you liked the post. Thank You for reading.</p>

<!-- Place this tag right after the last button or just before your close body tag. -->
<script async="" defer="" id="github-bjs" src="https://buttons.github.io/buttons.js"></script>


  </article>
  
  <center>
<span class='st__large' displayText=''></span>
<span class='st_facebook_large' displayText='Facebook'></span>
<span class='st_googleplus_large' displayText='Google +'></span>
<span class='st_twitter_large' displayText='Tweet'></span>
<span class='st_evernote_large' displayText='Evernote'></span>
<span class='st_tumblr_large' displayText='Tumblr'></span>
<span class='st_baidu_large' displayText='Baidu'></span>
<span class='st_linkedin_large' displayText='LinkedIn'></span>
<span class='st_pinterest_large' displayText='Pinterest'></span>
<span class='st_email_large' displayText='Email'></span>
</center>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'hanzratech'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper" style="font-family: 'Roboto', sans-serif;">

    <!-- <h2 class="footer-heading">Hanzra Tech</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
	<h3>Hanzra Tech</h3>
        <ul class="contact-list">
	  <li>Bikramjot Singh Hanzra</li>
	  <li><a href="mailto:bikz.05@gmail.com">bikz.05@gmail.com</a></li>
          
          <li>
            <a href="https://github.com/bikz05">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">bikz05</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/bikz05">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">bikz05</span>
            </a>
          </li>
          
                  </ul>
      </div>

      <div class="footer-col  footer-col-2" style="text-align: center">
      </div>

      <div class="footer-col  footer-col-3">
	<h3>Subscribe to the mailing list</h3>
	<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//hanzratech.us10.list-manage.com/subscribe/post?u=a52f12efb0d1b0d41d887206e&amp;id=647ba168eb" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<!-- <h2>Subscribe to our mailing list</h2> -->
<!-- <div class="indicates-required"><span class="asterisk">*</span> indicates required</div> -->
<div class="mc-field-group">
	<label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
</label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_a52f12efb0d1b0d41d887206e_647ba168eb" tabindex="-1" value=""></div>
    <div class="clear" ><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
<!--End mc_embed_signup-->

        <!-- <p class="text">Computer Vision and Programming blog
</p> -->
      </div>
    </div>

    <div style="text-align: center">
    Computer Vision and Programming Blog <br>
    Copyright &#169 2014 All rights reserved <a href="/">Hanzra Tech</a>
    </div>
  </div>

</footer>


  </body>

</html>
